<tool id="ensembl_vep" name="Ensemble Variant Effect Predictor" version="0.99">
<command interpreter="bash">
    ./ensemble.sh ${input} ${cb_sift} ${cb_polyphen} ${cb_condel} ${cb_regulatory} ${cb_protein} ${cb_hgnc} ${cb_ccds} ${cb_mostSevere} ${cb_summary} ${cb_perGene} ${cb_codingOnly} ${cb_checkExisting} ${cb_checkAlleles} > ${output}
</command>

<inputs>
    <param name="input" format="vcf" type="data" label="VCF file"/>

    <param name="cb_sift" label="Display SIFT information" type="boolean" truevalue="sift" falsevalue="no-sift" />
    <param name="cb_polyphen" label="Display Polyphen information" type="boolean" truevalue="polyphen" falsevalue="no-polyphen" />
    <param name="cb_condel" label="Display Condel information" type="boolean" truevalue="condel" falsevalue="no-condel" />
    <param name="cb_regulatory" label="Display Regulatory information" type="boolean" truevalue="regulatory" falsevalue="no-regulatory" />
    <param name="cb_protein" label="Display Protein information" type="boolean" truevalue="protein" falsevalue="no-protein" />
    <param name="cb_hgnc" label="Display HGNC information" type="boolean" truevalue="hgnc" falsevalue="no-hgnc" />
    <param name="cb_ccds" label="Display CCDS information" type="boolean" truevalue="ccds" falsevalue="no-ccds" />
    <param name="cb_mostSevere" label="Display Most Severe information" type="boolean" truevalue="mostSevere" falsevalue="no-mostSevere" />
    <param name="cb_summary" label="Display Summary information" type="boolean" truevalue="summary" falsevalue="no-summary" />
    <param name="cb_perGene" label="Display Per Gene information" type="boolean" truevalue="per_gene" falsevalue="no-perGene" />
    <param name="cb_codingOnly" label="Display Coding Region Only information" type="boolean" truevalue="codingOnly" falsevalue="no-codingOnly" />
    <param name="cb_checkExisting" label="Check existing variants" type="boolean" truevalue="check_existing" falsevalue="no-checkExisting" />
    <param name="cb_checkAlleles" label="When checking for existing variants, only report a co-located variant if none of the alleles supplied are novel" type="boolean" truevalue="checkAlleles" falsevalue="no-checkAlleles" />
    
</inputs>

<outputs>
    <data name="output" format="txt" type="data" label="Ensemble VEP on ${input}"/>
</outputs>

<help>
-- Sift --

SIFT predicts whether an amino acid substitution affects protein function based on sequence homology and the physical properties of amino acids. The VEP can output the prediction term, score or both. Using SIFT requires a database connection - while it can be used with --cache, the database will still be accessed to retrieve SIFT data.

-- Polyphen --

PolyPhen is a tool which predicts possible impact of an amino acid substitution on the structure and function of a human protein using straightforward physical and comparative considerations. The VEP can output the prediction term, score or both. Using PolyPhen requires a database connection - while it can be used with --cache, the database will still be accessed to retrieve PolyPhen data.

-- Condel --

Condel computes a weighted average of the scores (WAS) of several computational tools aimed at classifying missense mutations as likely deleterious or likely neutral.

-- Regulatory --

Look for overlaps with regulatory regions. The script can also call if a variant falls in a high information position within a transcription factor binding site. Output lines have a Feature type of RegulatoryFeature or MotifFeature.

-- Protein --

Add the Ensembl protein identifier to the output where appropriate.

-- HGNC --

Adds the HGNC gene identifer (where available) to the output.

-- CCDS --

Adds the CCDS transcript identifer (where available) to the output.

-- Canonical --

Adds a flag indicating if the transcript is the canonical transcript for the gene.

-- Most Severe --

Output only the most severe consequence per variation. Transcript-specific columns will be left blank.

-- Summary --

Output only a comma-separated list of all observed consequences per variation. Transcript-specific columns will be left blank.

-- Per Gene --

Output only the most severe consequence per gene. The transcript selected is arbitrary if more than one has the same predicted consequence.

-- Coding Only --

Only return consequences that fall in the coding regions of transcripts.

-- Check Existing --

Checks for the existence of variants that are co-located with your input. By default the alleles are not compared - to do so, use --check_alleles.

-- Check Alleles --

When checking for existing variants, only report a co-located variant if none of the alleles supplied are novel. For example, if the user input has alleles A/G, and an existing co-located variant has alleles A/C, the co-located variant will not be reported.

Strand is also taken into account - in the same example, if the user input has alleles T/G but on the negative strand, then the co-located variant will be reported since its alleles match the reverse complement of user input.

</help>
</tool>
